---
title: "Référence API - v2.0"
description: "Documentation API complète pour v2.0 avec support GraphQL"
---

# API Salsa comme Service v2.0

L'API v2.0 ajoute le support GraphQL, des webhooks améliorés et de nouveaux endpoints de prévision IA.

<Callout type="info">
**Nouveau dans v2.0 :** endpoint GraphQL disponible sur `https://api.salsaasaservice.com/graphql`.
</Callout>

---

## Navigation rapide

<CardGroup>
  <Card title="Authentification" href="#authentification">
    Clés API, en-têtes et exemple.
  </Card>

  <Card title="GraphQL" href="#api-graphql-nouveau-dans-v20">
    Endpoint, requête et abonnements.
  </Card>

  <Card title="Prévisions IA" href="#previsions-ia-nouveau-dans-v20">
    Forecast + entraînement du modèle.
  </Card>

  <Card title="Webhooks" href="#webhooks-v2-ameliore">
    Événements et configuration.
  </Card>
</CardGroup>

---

## URL de base

```text
https://api.salsaasaservice.com/v2
```

<Callout type="info">
**GraphQL :** `https://api.salsaasaservice.com/graphql`
</Callout>

---

## Authentification {#authentification}

Toutes les requêtes API nécessitent une authentification avec votre clé API.

### En-tête d'authentification

```http
Authorization: Bearer VOTRE_CLE_API
```

<Callout type="warning">
**Changement v2.0 :** Les clés API v1.0 ne fonctionnent pas avec v2.0. Générez une nouvelle clé depuis **Paramètres > Développeur > API v2.0**.
</Callout>

---

## Limites de taux

- **Plan Starter** : 10 000 requêtes par heure (augmenté depuis v1.0)
- **Plan Professionnel** : 100 000 requêtes par heure
- **Plan Entreprise** : Illimité

---

## API GraphQL (Nouveau dans v2.0)

### Endpoint GraphQL

```text
https://api.salsaasaservice.com/graphql
```

### Exemple de requête

```graphql
query GetProductionForecast {
  forecast(location: "loc_123", days: 7) {
    date
    recipes {
      id
      name
      predictedDemand {
        quantity
        unit
        confidence
      }
    }
  }
}
```

### Abonnements en temps réel

<Callout type="info">
**Nouveau dans v2.0 :** abonnements WebSocket pour des mises à jour en direct.
</Callout>

```graphql
subscription OnQualityAlert {
  qualityAlert(location: "loc_123") {
    id
    severity
    sensorId
    message
    timestamp
  }
}
```

### Explorer GraphQL interactif

```text
https://api.salsaasaservice.com/graphql/explorer
```

---

## API REST

L'API REST reste disponible pour compatibilité.

### Endpoints principaux

**[Gestion d'inventaire](#inventaire)**  
Gérez ingrédients, stock et fraîcheur.

**[Prévisions IA](#previsions-ia-nouveau-dans-v20)**  
Nouveau dans v2.0 : accédez aux prévisions de demande alimentées par IA.

**[Capteurs IoT](#capteurs-iot-nouveau-dans-v20)**  
Nouveau dans v2.0 : gérez capteurs et lectures.

**[Production](#production)**  
Suivez lots de production et qualité.

---

## Inventaire {#inventaire}

Cette section suit la même logique que v1, mais avec des améliorations de cohérence et de validation côté v2.

---

## Prévisions IA (Nouveau dans v2.0) {#previsions-ia-nouveau-dans-v20}

### Obtenir les prévisions de demande

Récupérez les prévisions alimentées par IA pour vos recettes.

```http
GET /v2/ai/forecast?location=loc_123&days=7
```

**Réponse :**

```json
{
  "forecast_period": {
    "start_date": "2024-01-20",
    "end_date": "2024-01-27",
    "days": 7
  },
  "predictions": [
    {
      "date": "2024-01-20",
      "recipe_id": "rec_456",
      "recipe_name": "Salsa maison",
      "predicted_demand": {
        "quantity": 12.5,
        "unit": "gallons",
        "confidence_interval": [11.2, 13.8],
        "confidence_level": 0.95
      },
      "factors": {
        "day_of_week": "Vendredi (+20%)",
        "weather": "Ensoleillé (+5%)",
        "events": ["Concert local (+10%)"]
      }
    }
  ],
  "model_accuracy": {
    "mape": 5.2,
    "last_updated": "2024-01-19T08:00:00Z"
  }
}
```

### Entraîner le modèle IA

Réentraînez le modèle avec de nouvelles données.

```http
POST /v2/ai/forecast/train
```

---

## Capteurs IoT (Nouveau dans v2.0) {#capteurs-iot-nouveau-dans-v20}

### Obtenir tous les capteurs

```http
GET /v2/iot/sensors?location=loc_123
```

**Réponse :**

```json
{
  "sensors": [
    {
      "id": "sensor_001",
      "name": "Capteur de température - Réfrigérateur 1",
      "type": "temperature",
      "location": "loc_123",
      "status": "online",
      "last_reading": {
        "value": 3.5,
        "unit": "celsius",
        "timestamp": "2024-01-20T10:30:00Z",
        "quality": "good"
      },
      "battery_level": 85
    }
  ]
}
```

### Obtenir les lectures de capteur

```http
GET /v2/iot/sensors/{sensor_id}/readings?start_date=2024-01-01&end_date=2024-01-31
```

### Configurer les alertes de capteur

```http
POST /v2/iot/sensors/{sensor_id}/alerts
```

**Corps de la requête :**

```json
{
  "alert_type": "threshold",
  "conditions": {
    "min_value": 2.0,
    "max_value": 4.0,
    "unit": "celsius"
  },
  "notification_channels": ["email", "sms", "slack"],
  "severity": "high"
}
```

---

## Production {#production}

Cette section suit la logique des lots (batch) comme v1, avec plus de signaux qualité en v2.

---

## Webhooks v2 (Amélioré) {#webhooks-v2-ameliore}

<Accordion title="Nouveau dans v2.0 : améliorations clés">
- Livraison garantie avec logique de réessai  
- Filtrage et routage d'événements  
- Vérification de signature  
- Suivi de statut de livraison  
</Accordion>

### Événements disponibles

- `forecast.updated` : Prévisions IA mises à jour  
- `sensor.reading` : Nouvelle lecture de capteur  
- `sensor.alert` : Alerte de capteur déclenchée  
- `production.batch_completed` : Lot de production terminé  
- `inventory.low_stock` : Stock faible détecté  
- `quality.alert` : Problème de qualité détecté  

### Configurer un webhook

```http
POST /v2/webhooks
```

**Corps de la requête :**

```json
{
  "url": "https://votre-app.com/webhooks/salsa",
  "events": [
    "forecast.updated",
    "sensor.alert",
    "production.batch_completed"
  ],
  "secret": "votre_secret_webhook",
  "active": true
}
```

### Exemple de payload webhook

```json
{
  "event": "sensor.alert",
  "timestamp": "2024-01-20T10:30:00Z",
  "data": {
    "alert_id": "alert_789",
    "sensor_id": "sensor_001",
    "severity": "high",
    "message": "Température hors limites",
    "reading": {
      "value": 8.5,
      "threshold": 4.0,
      "unit": "celsius"
    }
  },
  "signature": "sha256=abc123..."
}
```

---

## SDKs et bibliothèques

SDKs officiels pour v2.0 :

- [JavaScript/Node.js](https://github.com/salsaasaservice/salsa-js-v2)  
- [Python](https://github.com/salsaasaservice/salsa-python-v2)  
- [PHP](https://github.com/salsaasaservice/salsa-php-v2)  

---

## Environnement Sandbox

Testez vos intégrations dans un environnement sûr.

```text
https://api-sandbox.salsaasaservice.com/v2
```

<Callout type="warning">
L'environnement sandbox utilise des données de test et n'affecte pas votre compte de production.
</Callout>

---

## Support

Besoin d'aide avec l'API v2.0 ?

- Email : api-support@salsaasaservice.com
- Documentation : documentation GraphQL et REST
- Discord développeur : rejoignez notre communauté
- Tutoriels : tutoriels d'intégration vidéo

<Callout type="info">
Support API amélioré : les clients v2.0 reçoivent un support prioritaire et un accès à nos ingénieurs API.
</Callout>
